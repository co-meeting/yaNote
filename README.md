# yaNote

**yaNote** は、ブラウザ上で動作するジグザグ型ノートアプリです。  
ノード（メモ）を作成し、それらを自由に接続することで、情報を視覚的に整理できます。

📌 **[デモページ（GitHub Pages）](https://co-meeting.github.io/yaNote/)**  
👉 **ブラウザで今すぐ試せます！**

📖 **[ヘルプページ](help.md)**  
👉 **使い方の詳細はこちら！**

---

## 🚀 アップデート情報 (v1.2.8)

### 主な変更点
- **タイトルフィールドの追加**
  - コントロールパネル内にタイトルフィールドを追加
  - 初回、中心ノードの編集確定時に自動反映し、その後はユーザーが手動で更新
  - 編集中は左寄せ、確定後は右寄せに切り替え
  - 入力が空の場合は「無題」と表示され、エクスポート時のファイル名にも反映

- **ツールチップ位置の調整**
  - ツールチップの表示基準をビューポート（position: fixed）に変更

- **キー入力動作の改善**
  - タイトルフィールドでは、BackSpace の削除動作が正しく動作するよう修正
  - Enter キーによる編集確定処理で、IME変換中は確定しないように調整

- **その他の改善**
  - コントロールパネルを常に画面右上に固定表示
  - 全体のバージョン番号を v1.2.8 に更新

### 詳細な更新内容
- タイトルフィールドの実装により、エクスポート時のファイル名が「タイトル_yaNote_YYYY-MM-DD_HH-MM-SS.json」形式となります。
- タイトルフィールドの表示時は右寄せ、編集中は左寄せに自動切替し、入力内容全体が見えるように幅を自動調整します。
- ツールチップの位置調整、BackSpace キーおよび Enter キーの挙動改善を実施しました。

---

## 📌 機能比較

| 機能                | v1.2.7                                          | v1.2.8                                        |
|---------------------|-------------------------------------------------|-----------------------------------------------|
| タイトルフィールド  | なし                                            | **追加：タイトルフィールドによるファイル名設定** 🆕 |
| タイトルの表示      | -                                               | **表示時は右寄せ、編集時は左寄せ** 🆕              |
| ツールチップ表示    | 位置ずれあり                                    | **位置調整済み（position: fixed採用）** 🆕        |
| BackSpace キー挙動  | 入力フィールドで削除不可                        | **修正済み（入力フィールド除外）** 🆕             |
| Enter キー挙動      | 編集中にIME変換中でも確定してしまう               | **IME変換中は確定しないよう調整** 🆕               |
| コントロールパネル  | 画面右上に配置（canvas 内に含まれていたためずれる） | **常に画面右上に固定表示（position: fixed）** 🆕   |
| ノード・線の操作    | 複数行対応、グループ移動対応                      | そのまま                                      |

---

## 📌 主な機能

### 📝 ノードの作成・編集
- **ダブルクリックでノードを作成**
- **Enterキー2回押下で編集完了**
- **Shift+Enterで複数行テキスト入力**
- **ドラッグでノードを移動可能**
- **ノードの種類を切り替え可能（標準 / テキストのみ）**
- **太字機能で重要ポイントを強調**

### 📍 ノードの接続
- **ドラッグ＆ドロップでノード同士を接続**
- **未接続の線を自由に移動可能**
- **接続線の端点をドラッグして再接続可能**
- **線種を切り替え可能（4種類から選択）**
- **実線/点線の切り替えが可能**

### 🎯 選択と削除
- **クリックで選択**
- **Shift + クリックで複数選択**
- **Delete / Backspace で削除**
- **右クリックメニューからも削除可能**
- **ラバーバンド選択対応（ドラッグで範囲選択）**

### 🔄 Undo / Redo
- **Ctrl + Z / Cmd + Z** → 元に戻す
- **Ctrl + Y / Cmd + Y** → やり直し

### 🔀 エクスポート・インポート機能
- **ノードと接続情報を JSON 形式でエクスポート**
- **ノードの種類、線種、太字設定もエクスポート時に保存**
- **エクスポート時のファイル名にタイトルフィールドの内容（空なら「無題」）を使用**
- **エクスポートしたデータをインポート可能**
- **ローカルストレージに自動保存、複数タブ間の同期対応**

### 🖱️ 直感的な操作
- **右クリックでコンテキストメニュー**
- **右クリック+ドラッグでパン移動**
- **マウスホイールでのパン移動**
- **Shiftキー+ホイールで横方向パン**
- **トラックパッド二本指スクロールでのパン移動**

📖 **詳しい使い方は [ヘルプページ](help.md) をご覧ください！**

---

## 🛠 技術詳細

- **言語**: HTML, CSS, JavaScript
- **レンダリング最適化**:
  - ノードの位置は `transform` で管理
  - 接続線の矢印位置を自動計算
  - グループ選択時に接続線が正確に追従
- **データ管理**
  - ローカルストレージへの自動保存
  - JSON 形式でのエクスポート・インポート
  - バージョン管理とマイグレーション機能
  - 複数タブ間のデータ同期対応
- **UI/UX**
  - ツールチップによる視覚的フィードバック（position: fixed 採用）
  - ボタンのアイコン表示と状態表示
  - 直感的なドラッグ＆ドロップ操作

---

## 🔧 クラス構成

| クラス名       | 説明 |
|----------------|-------------------------------|
| `YaNoteApp`    | アプリ全体の管理、パン操作、右クリックメニュー |
| `NoteNode`     | ノードオブジェクト（位置管理、テキスト編集、種類・太字設定） |
| `Connection`   | 接続線オブジェクト（線種・実線/点線切替、ドラッグ操作） |
| `Logger`       | デバッグ用ログ出力 |
| `Utils`        | 幾何計算、座標処理、バージョン管理、ツールチップ管理 |

---

## 🚀 今後のロードマップ

- 🔍 **ズーム機能の改善**
- 🎨 **ノードの色変更機能**
- 📂 **エクスポート形式の拡張（PNG / SVG）**
- 📱 **モバイル対応の強化**
- 🔀 **ノードのグループ化機能**
- 🖼 **ミニマップの実装**

---
